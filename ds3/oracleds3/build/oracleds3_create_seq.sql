-- DS3 Create sequence script that will create seqences for Reviews and Reviews Helpfulness tables

DECLARE 
  REVIEW_ROWS NUMBER;
  HELP_ROWS NUMBER;

BEGIN

  SELECT count(*) INTO REVIEW_ROWS  from "DS3"."REVIEWS";

REVIEW_ROWS := REVIEW_ROWS + 1;

EXECUTE IMMEDIATE '
CREATE SEQUENCE "DS3"."REVIEWID_SEQ"
  INCREMENT BY 1
  START WITH ' || REVIEW_ROWS || '
  MAXVALUE 1.0E28
  MINVALUE 1
  NOCYCLE
  CACHE 100000
  NOORDER'
  ;

  SELECT count(*) INTO HELP_ROWS  from "DS3"."REVIEWS_HELPFULNESS";

HELP_ROWS := HELP_ROWS + 1;

EXECUTE IMMEDIATE '
CREATE SEQUENCE "DS3"."REVIEWHELPFULNESSID_SEQ"
  INCREMENT BY 1
  START WITH ' || HELP_ROWS || '
  MAXVALUE 1.0E28
  MINVALUE 1
  NOCYCLE
  CACHE 100000
  NOORDER'
  ;
END;
/
EXIT;
